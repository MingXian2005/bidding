{% extends "layout.html" %}

{% block title %}Main Bidding Page{% endblock %}

{% block header %}
    {{ project.title }}
{% endblock %}

{% block body %}
<div class="container">
    <div class="image-section">
        <img src="{{ url_for('static', filename='images/project.jpg') }}" alt="Project Image" width="400" />
    </div>
    <div class="info-section">
        <p><strong>Start Price:</strong> ${{ project.start_price }}</p>
        <p><strong>Highest Bid:</strong> ${{ highest_bid }}</p>
        <p><strong>Start Date:</strong> {{ project.start_date.strftime('%Y-%m-%d %H:%M UTC') }}</p>
        <p><strong>Time Left:</strong> <span id="countdown"></span></p>
        <form method="POST">
            <label for="bid_price">Your Bid Price:</label><br />
            <input type="number" name="bid_price" step="0.01" min="{{ highest_bid + 0.01 }}" required /><br />
            <button type="submit">Submit Bid</button>
        </form>
        <p><a href="{{ url_for('logout') }}">Logout</a></p>
    </div>
</div>

<script>
// Countdown timer
let timeLeft = {{ time_left }};
const countdownEl = document.getElementById("countdown");

function updateCountdown() {
    if (timeLeft <= 0) {
        countdownEl.textContent = "Bidding ended";
        return;
    }
    let minutes = Math.floor(timeLeft / 60);
    let seconds = timeLeft % 60;
    countdownEl.textContent = `${minutes}m ${seconds}s`;
    timeLeft--;
    setTimeout(updateCountdown, 1000);
}

updateCountdown();
</script>
{% endblock %}
